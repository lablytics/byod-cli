import{r as c,j as t}from"./index-eBHcrhee.js";function S(){const[a,e]=c.useState({active:!1,progress:null,result:null,error:null}),s=c.useRef(null),v=c.useCallback(async(h,j)=>{var m;e({active:!0,progress:null,result:null,error:null});try{const r=await fetch(h,j);if(!r.ok){const n=await r.json().catch(()=>({detail:r.statusText}));e(d=>({...d,active:!1,error:n.detail||`HTTP ${r.status}`}));return}const l=(m=r.body)==null?void 0:m.getReader();if(!l){e(n=>({...n,active:!1,error:"No response body"}));return}s.current=l;const b=new TextDecoder;let u="";for(;;){const{done:n,value:d}=await l.read();if(n)break;u+=b.decode(d,{stream:!0});const x=u.split(`
`);u=x.pop()||"";let i="";for(const o of x)if(o.startsWith("event: "))i=o.slice(7).trim();else if(o.startsWith("data: ")){const f=JSON.parse(o.slice(6));i==="progress"?e(p=>({...p,progress:f})):i==="complete"?e({active:!1,progress:null,result:f,error:null}):i==="error"&&e(p=>({...p,active:!1,error:f.message}))}}}catch(r){e(l=>({...l,active:!1,error:r instanceof Error?r.message:"Connection failed"}))}},[]),g=c.useCallback(()=>{s.current&&(s.current.cancel(),s.current=null),e({active:!1,progress:null,result:null,error:null})},[]);return{...a,start:v,reset:g}}function N({progress:a,error:e,label:s}){return e?t.jsx("div",{className:"error-message",children:e}):a?t.jsxs("div",{className:"submission-progress",children:[s&&t.jsx("div",{style:{fontSize:"12px",color:"var(--text-dim)",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},children:s}),t.jsx("div",{className:"progress-message",children:a.message}),t.jsx("div",{className:"progress-bar",children:t.jsx("div",{className:"progress-fill",style:{width:`${a.percent}%`}})}),t.jsxs("div",{style:{fontSize:"12px",color:"var(--text-dim)",marginTop:"6px",textAlign:"right"},children:[a.percent,"%"]})]}):null}export{N as P,S as u};
